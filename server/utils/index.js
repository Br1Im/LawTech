/**
 * Общие утилиты для приложения
 */

// Генерация UUID v4 для RqUID
const generateUUID = () => {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
    const r = Math.random() * 16 | 0, 
          v = c === 'x' ? r : (r & 0x3 | 0x8);
    return v.toString(16);
  });
};

// Функция для локальной генерации ответов на юридические вопросы
const getLocalLegalResponse = (message) => {
  const lowercaseMessage = message.toLowerCase();
  
  if (lowercaseMessage.includes('договор') || lowercaseMessage.includes('контракт')) {
    return `В соответствии с Гражданским кодексом РФ договор считается заключенным, если между сторонами достигнуто соглашение по всем существенным условиям. Обязательно письменное заключение договора в случаях, предусмотренных законом, например, при сделках с недвижимостью, договоров займа на сумму более 10 тыс. рублей и т.д. При нарушении условий договора сторона имеет право требовать возмещения убытков и применения иных мер ответственности, предусмотренных законом или договором.`;
  } else if (lowercaseMessage.includes('наследств')) {
    return `По российскому законодательству наследование осуществляется по завещанию и по закону. При наследовании по закону имущество наследуется в порядке очередности (ст. 1141-1145 ГК РФ). Срок для принятия наследства составляет 6 месяцев со дня смерти наследодателя. Для принятия наследства необходимо подать заявление нотариусу по последнему месту жительства наследодателя или фактически принять наследство (ст. 1153 ГК РФ).`;
  } else if (lowercaseMessage.includes('развод') || lowercaseMessage.includes('расторжение брака')) {
    return `Расторжение брака производится в судебном порядке при наличии у супругов общих несовершеннолетних детей или при отсутствии согласия одного из супругов на развод. В органах ЗАГС брак расторгается при взаимном согласии супругов, не имеющих общих несовершеннолетних детей. Также через ЗАГС расторгается брак по заявлению одного из супругов, если другой супруг признан безвестно отсутствующим, недееспособным или осуждён на срок свыше трёх лет (ст. 19 Семейного кодекса РФ).`;
  } else if (lowercaseMessage.includes('налог')) {
    return `В России основными налогами для физических лиц являются НДФЛ (13% для резидентов, 15% для нерезидентов), налог на имущество (от 0,1% до 2%), земельный налог (до 0,3% для земель сельхозназначения и до 1,5% для прочих земель) и транспортный налог (ставка зависит от мощности двигателя). Декларация 3-НДФЛ подается до 30 апреля года, следующего за отчетным. Уплата налогов, начисленных по декларации, производится до 15 июля.`;
  } else if (lowercaseMessage.includes('трудов') || lowercaseMessage.includes('работ')) {
    return `Согласно Трудовому кодексу РФ, трудовой договор может быть расторгнут по инициативе работника (по собственному желанию), работодателя или по обстоятельствам, не зависящим от воли сторон. При увольнении по собственному желанию работник должен предупредить работодателя письменно за две недели. Работодатель может уволить работника по своей инициативе только по основаниям, предусмотренным ТК РФ (ст. 81). При сокращении штата работодатель обязан предупредить работника не менее чем за два месяца и выплатить выходное пособие.`;
  } else if (lowercaseMessage.includes('штраф') || lowercaseMessage.includes('коап')) {
    return `Штраф за нарушение ПДД можно обжаловать в течение 10 суток со дня вручения или получения постановления. Жалоба подается вышестоящему должностному лицу или в суд. При оплате штрафа ГИБДД в течение 20 дней со дня вынесения постановления предоставляется скидка 50% (за исключением некоторых серьезных нарушений). Срок давности для привлечения к административной ответственности составляет 2 месяца со дня совершения правонарушения, а для отдельных категорий дел - от 3 месяцев до 6 лет.`;
  } else {
    return `В соответствии с законодательством РФ, для получения квалифицированной юридической помощи по вашему вопросу рекомендую обратиться к профессиональному юристу или адвокату. Специалист сможет проанализировать конкретную ситуацию с учетом действующих правовых норм и судебной практики. 

Также вы можете получить бесплатную юридическую консультацию в государственном юридическом бюро или у адвоката в рамках системы бесплатной юридической помощи в соответствии с ФЗ "О бесплатной юридической помощи в РФ".`;
  }
};

module.exports = {
  generateUUID,
  getLocalLegalResponse
}; 